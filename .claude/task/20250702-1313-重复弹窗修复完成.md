# 20250702-1313 é‡å¤ Tooltip Detail å¼¹çª—ä¿®å¤å®Œæˆ

## é—®é¢˜æè¿°

ç”¨æˆ·æŠ¥å‘Šäº†ä¸€ä¸ªä¸¥é‡çš„UIé—®é¢˜ï¼šå½“åœ¨æ‚¬æµ®çŠ¶æ€ä¸‹å°†å…‰æ ‡ä»ä¸€ä¸ªå·²é«˜äº®çš„å•è¯ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå·²é«˜äº®çš„å•è¯ï¼Œå¹¶åˆ†åˆ«æŒ‰ä¸‹ Shift é”®æ—¶ï¼Œä¼šåŒæ—¶å‡ºç°ä¸¤ä¸ªè¯¦æƒ…å¼¹çª—ï¼Œè€Œä¸æ˜¯åªæ˜¾ç¤ºå½“å‰å•è¯çš„å¼¹çª—ã€‚

## å…·ä½“æµç¨‹
1. é¦–å…ˆå°†å…‰æ ‡æ‚¬æµ®äºä¸€ä¸ªå·²é«˜äº®æ˜¾ç¤ºçš„å•è¯ä¹‹ä¸Šï¼ŒæŒ‰ä¸‹ Shift é”®åå¼¹å‡ºè¯¦ç»†çš„ ToolTip
2. è€Œåï¼Œåœ¨æ‚¬æµ®çŠ¶æ€ä¸‹ï¼Œå°†å…‰æ ‡ç½®äºå¦ä¸€ä¸ªå·²é«˜äº®çš„å•è¯ä¸Šï¼Œå†æ¬¡æŒ‰ä¸‹ Shift é”®
3. æ­¤æ—¶ä¸¤ä¸ªè¯¦æƒ…ä¼šåŒæ—¶å‡ºç°ï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„è¡Œä¸º

## ç”¨æˆ·æä¾›çš„æ—¥å¿—
```
[TooltipManager] Switching to detailed mode for word: "chrome"
[PopupService] Shown popup in Shadow DOM: "toolfull-detailed-chrome"
[TooltipManager] Switching to detailed mode for word: "favorite"  
[PopupService] Shown popup in Shadow DOM: "toolfull-detailed-favorite"
```

## é—®é¢˜æ ¹å› 

åœ¨ `TooltipManager.tsx` çš„ `showDetailedView` æ–¹æ³•ä¸­ï¼Œç¼ºå°‘å¯¹å·²å­˜åœ¨è¯¦ç»†å¼¹çª—çš„æ£€æŸ¥å’Œæ¸…ç†ã€‚å½“ç”¨æˆ·ä»ä¸€ä¸ªå•è¯åˆ‡æ¢åˆ°å¦ä¸€ä¸ªå•è¯æ—¶ï¼Œæ—§çš„è¯¦ç»†å¼¹çª—æ²¡æœ‰è¢«å…³é—­ï¼Œå¯¼è‡´å¤šä¸ªè¯¦ç»†å¼¹çª—åŒæ—¶å­˜åœ¨ã€‚

## ä¿®å¤æ–¹æ¡ˆ

åœ¨ `TooltipManager.tsx` çš„ `showDetailedView` æ–¹æ³•ä¸­æ·»åŠ çŠ¶æ€æ£€æŸ¥é€»è¾‘ï¼š

```typescript
async showDetailedView(word: string, targetElement: HTMLElement): Promise<void> {
  try {
    // å¦‚æœæ­£åœ¨è½¬æ¢ä¸­ï¼Œç›´æ¥è¿”å›
    if (this.isTransitioning) {
      console.log(`[TooltipManager] Currently transitioning, ignoring request for word: "${word}"`);
      return;
    }

    // å¦‚æœå·²ç»æ˜¯è¯¦ç»†æ¨¡å¼ï¼Œå…ˆå…³é—­å½“å‰çš„è¯¦ç»†å¼¹çª—å†åˆ‡æ¢åˆ°æ–°çš„
    if (this.currentMode === "detailed") {
      const currentWord = this.stateManager.getCurrentWord();
      if (currentWord && currentWord !== word) {
        console.log(`[TooltipManager] Switching from "${currentWord}" to "${word}" detailed view`);
        // å…³é—­å½“å‰çš„è¯¦ç»†å¼¹çª—
        popupService.hide(`toolfull-detailed-${currentWord}`);
      } else if (currentWord === word) {
        console.log(`[TooltipManager] Already showing detailed view for word: "${word}"`);
        return;
      }
    }
    
    // ... å…¶ä½™é€»è¾‘ä¿æŒä¸å˜
  }
}
```

## ä¿®å¤å…³é”®ç‚¹

1. **è½¬æ¢çŠ¶æ€ä¿æŠ¤**: ä½¿ç”¨ `isTransitioning` æ ‡å¿—é˜²æ­¢é‡å¤è°ƒç”¨
2. **è¯¦ç»†æ¨¡å¼æ£€æŸ¥**: æ£€æŸ¥å½“å‰æ˜¯å¦å·²ç»å¤„äºè¯¦ç»†æ¨¡å¼
3. **å•è¯åˆ‡æ¢é€»è¾‘**: å¦‚æœæ˜¯åˆ‡æ¢åˆ°ä¸åŒå•è¯ï¼Œä¸»åŠ¨å…³é—­æ—§å¼¹çª—
4. **é‡å¤è¯·æ±‚ä¿æŠ¤**: å¦‚æœè¯·æ±‚çš„æ˜¯ç›¸åŒå•è¯ï¼Œç›´æ¥è¿”å›

## é¢„æœŸç»“æœ

ä¿®å¤åï¼Œç”¨æˆ·åœ¨é«˜äº®å•è¯é—´åˆ‡æ¢æ—¶ï¼š
- åªä¼šæ˜¾ç¤ºå½“å‰æ¿€æ´»å•è¯çš„è¯¦ç»†å¼¹çª—
- ä¹‹å‰çš„è¯¦ç»†å¼¹çª—ä¼šè‡ªåŠ¨å…³é—­
- é¿å…å¤šä¸ªè¯¦ç»†å¼¹çª—åŒæ—¶å­˜åœ¨çš„é—®é¢˜

## æ–‡ä»¶ä¿®æ”¹

- `src/utils/dom/managers/tooltip/TooltipManager.tsx`: æ·»åŠ è¯¦ç»†å¼¹çª—åˆ‡æ¢é€»è¾‘

## æµ‹è¯•çŠ¶æ€

- âœ… ä»£ç ä¿®å¤å®Œæˆ
- ğŸŸ¡ å¼€å‘æœåŠ¡å™¨å·²å¯åŠ¨ï¼Œç­‰å¾…å®é™…æµ‹è¯•éªŒè¯

## ç›¸å…³é—®é¢˜

æ­¤ä¿®å¤è§£å†³äº†ç”¨æˆ·æŠ¥å‘Šçš„ tooltip detail é‡å¤æ˜¾ç¤ºé—®é¢˜ï¼Œç¡®ä¿äº†è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚