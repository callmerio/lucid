# WXT æŒä¹…åŒ–å¼€å‘é…ç½®æ–‡ä»¶è®¾ç½®

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½•äº†å¦‚ä½•é…ç½®WXTæ¥ç®¡ç†ä¸€ä¸ªæŒä¹…åŒ–çš„å¼€å‘æµè§ˆå™¨é…ç½®æ–‡ä»¶ï¼Œè§£å†³æ‰©å±•åœ¨å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦é‡å¤åŠ è½½çš„é—®é¢˜ã€‚

## ğŸ¯ è§£å†³çš„é—®é¢˜

- **æ‰©å±•é‡å¤åŠ è½½**: æ¯æ¬¡é‡å¯å¼€å‘æœåŠ¡å™¨æ—¶ï¼Œæ‰©å±•éœ€è¦é‡æ–°åŠ è½½
- **å¼€å‘å·¥å…·ä¸¢å¤±**: æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ‰©å±•å’Œè®¾ç½®åœ¨é‡å¯åä¸¢å¤±
- **ç™»å½•çŠ¶æ€ä¸¢å¤±**: æµ‹è¯•ç½‘ç«™çš„ç™»å½•çŠ¶æ€æ— æ³•ä¿æŒ
- **é…ç½®é‡ç½®**: æµè§ˆå™¨è®¾ç½®å’Œåå¥½åœ¨æ¯æ¬¡å¯åŠ¨æ—¶é‡ç½®

## âš™ï¸ é…ç½®æ–¹æ¡ˆ

### 1. web-ext.config.ts é…ç½®

```typescript
import { defineWebExtConfig } from 'wxt';

export default defineWebExtConfig({
  binaries: {
    // æµè§ˆå™¨äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„é…ç½®
    chrome: '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome',
    // å…¶ä»–æµè§ˆå™¨...
  },
  disabled: false,
  startUrls: [
    'https://blog.google/products/chrome/favorite-google-chrome-extensions-2023/',
    'https://www.google.com/search?q=tailwind+css'
  ],
  
  // ğŸ”‘ æŒä¹…åŒ–é…ç½®æ–‡ä»¶æ ¸å¿ƒè®¾ç½®
  chromiumArgs: [
    '--user-data-dir=./.wxt/chrome-data', // åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»ºæŒä¹…åŒ–é…ç½®æ–‡ä»¶
    '--disable-web-security', // å¼€å‘æ—¶ç¦ç”¨ä¸€äº›å®‰å…¨é™åˆ¶
    '--disable-features=VizDisplayCompositor', // æé«˜å…¼å®¹æ€§
  ],
  keepProfileChanges: true, // ä¿æŒé…ç½®æ–‡ä»¶çš„æ›´æ”¹
});
```

### 2. wxt.config.ts é…ç½®ä¼˜åŒ–

```typescript
export default defineConfig({
  // ... å…¶ä»–é…ç½®
  dev: {
    server: {
      port: 3000, // ä½¿ç”¨é»˜è®¤ç«¯å£3000
      host: 'localhost',
    },
    // å¼€å‘è€…å·¥å…·è‡ªåŠ¨æ‰“å¼€é…ç½®
    ...({
      browserFlags: [
        "--auto-open-devtools-for-tabs",
        "--enable-features=AutoOpenDevToolsForPopups",
      ],
    } as any),
  },
  // ... å…¶ä»–é…ç½®
});
```

## ğŸ“ ç›®å½•ç»“æ„

é…ç½®å®Œæˆåï¼Œé¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
.wxt/
â”œâ”€â”€ chrome-data/           # æŒä¹…åŒ–Chromeé…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ Default/          # é»˜è®¤ç”¨æˆ·é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ Local State       # æœ¬åœ°çŠ¶æ€æ–‡ä»¶
â”‚   â””â”€â”€ ...              # å…¶ä»–Chromeé…ç½®æ–‡ä»¶
â”œâ”€â”€ eslint-auto-imports.mjs
â”œâ”€â”€ tsconfig.json
â””â”€â”€ types/
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm dev
```

### éªŒè¯é…ç½®

1. **æ£€æŸ¥æŒä¹…åŒ–ç›®å½•**: ç¡®è®¤ `.wxt/chrome-data` ç›®å½•å·²åˆ›å»º
2. **æµ‹è¯•æ‰©å±•åŠ è½½**: æ‰“å¼€æµ‹è¯•é¡µé¢ `test_extension_loading.html`
3. **éªŒè¯é…ç½®ä¿æŒ**: é‡å¯å¼€å‘æœåŠ¡å™¨ï¼Œæ£€æŸ¥æµè§ˆå™¨è®¾ç½®æ˜¯å¦ä¿æŒ

### æµ‹è¯•é¡µé¢

ä½¿ç”¨ `test_extension_loading.html` æ¥éªŒè¯ï¼š
- æ‰©å±•æ˜¯å¦æ­£ç¡®åŠ è½½
- Content scriptæ˜¯å¦æ³¨å…¥
- å¼€å‘æœåŠ¡å™¨çŠ¶æ€
- æ‰©å±•åŠŸèƒ½æ˜¯å¦æ­£å¸¸

## ğŸ”§ æ•…éšœæ’é™¤

### ç«¯å£å†²çª

å¦‚æœé‡åˆ°ç«¯å£3000è¢«å ç”¨ï¼š

```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -ti:3000

# ç»ˆæ­¢è¿›ç¨‹
kill -9 <PID>
```

### æ‰©å±•æœªåŠ è½½

1. æ£€æŸ¥ `.output/chrome-mv3-dev/` ç›®å½•æ˜¯å¦å­˜åœ¨
2. ç¡®è®¤ `manifest.json` æ–‡ä»¶æ˜¯å¦æ­£ç¡®ç”Ÿæˆ
3. æŸ¥çœ‹æµè§ˆå™¨æ‰©å±•ç®¡ç†é¡µé¢ï¼Œç¡®è®¤æ‰©å±•å·²å¯ç”¨

### é…ç½®æ–‡ä»¶æƒé™

ç¡®ä¿ `.wxt/chrome-data` ç›®å½•æœ‰æ­£ç¡®çš„è¯»å†™æƒé™ï¼š

```bash
chmod -R 755 .wxt/chrome-data
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ç‰ˆæœ¬æ§åˆ¶**: `.wxt` ç›®å½•å·²åœ¨ `.gitignore` ä¸­æ’é™¤ï¼Œä¸ä¼šæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
2. **ç£ç›˜ç©ºé—´**: æŒä¹…åŒ–é…ç½®æ–‡ä»¶ä¼šå ç”¨ä¸€å®šç£ç›˜ç©ºé—´
3. **æ¸…ç†**: å¦‚éœ€é‡ç½®é…ç½®ï¼Œåˆ é™¤ `.wxt/chrome-data` ç›®å½•å³å¯
4. **è·¨å¹³å°**: Windowsç”¨æˆ·éœ€è¦ä½¿ç”¨ç»å¯¹è·¯å¾„é…ç½®

## ğŸ‰ ä¼˜åŠ¿

- âœ… **å¼€å‘æ•ˆç‡æå‡**: æ— éœ€é‡å¤é…ç½®æµè§ˆå™¨å’Œæ‰©å±•
- âœ… **çŠ¶æ€ä¿æŒ**: ç™»å½•çŠ¶æ€ã€è®¾ç½®åå¥½ç­‰å¾—ä»¥ä¿æŒ
- âœ… **å·¥å…·é›†æˆ**: å¼€å‘è€…å·¥å…·æ‰©å±•å¯ä»¥æŒä¹…å®‰è£…
- âœ… **æµ‹è¯•ä¾¿åˆ©**: å¯ä»¥å®‰è£…æµ‹è¯•ç”¨çš„å…¶ä»–æ‰©å±•
- âœ… **é…ç½®éš”ç¦»**: æ¯ä¸ªé¡¹ç›®æœ‰ç‹¬ç«‹çš„æµè§ˆå™¨é…ç½®

## ğŸ”— ç›¸å…³èµ„æº

- [WXT Browser Startup å®˜æ–¹æ–‡æ¡£](https://wxt.dev/guide/essentials/config/browser-startup)
- [web-ext é…ç½®å‚è€ƒ](https://www.npmjs.com/package/web-ext)
- [Chrome å‘½ä»¤è¡Œå‚æ•°](https://peter.sh/experiments/chromium-command-line-switches/)
