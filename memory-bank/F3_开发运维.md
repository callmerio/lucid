# ğŸ› ï¸ F3_å¼€å‘è¿ç»´.md

## ğŸ—ï¸ ç¯å¢ƒæ­å»º

### ç³»ç»Ÿè¦æ±‚
- **Node.js** >= 18.0.0
- **pnpm** >= 8.0.0 (æ¨èåŒ…ç®¡ç†å™¨)
- **Chrome/Firefox** å¼€å‘è€…ç‰ˆæœ¬

### å¿«é€Ÿå¯åŠ¨
```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd lucid

# 2. å®‰è£…ä¾èµ–
pnpm install

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev              # Chromeå¼€å‘
pnpm dev:firefox      # Firefoxå¼€å‘

# 4. åŠ è½½æ‰©å±•
# Chrome: chrome://extensions/ -> å¼€å‘è€…æ¨¡å¼ -> åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº
# Firefox: about:debugging -> ä¸´æ—¶åŠ è½½é™„åŠ ç»„ä»¶
```

### å¼€å‘å·¥å…·é…ç½®
```json
// .vscode/settings.json
{
  "typescript.preferences.importModuleSpecifier": "relative",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "files.associations": {
    "*.tsx": "typescriptreact"
  }
}
```

## ğŸ“ é¡¹ç›®ç»“æ„è¯¦è§£

```
lucid/
â”œâ”€â”€ ğŸ“‚ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“‚ components/         # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ tooltip/          # Tooltipç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ highlight/        # é«˜äº®ç»„ä»¶
â”‚   â”‚   â””â”€â”€ common/           # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ ğŸ“‚ services/          # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ dictionary/       # è¯å…¸æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ highlight/        # é«˜äº®æœåŠ¡
â”‚   â”‚   â””â”€â”€ storage/          # å­˜å‚¨æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“‚ hooks/             # React Hooks
â”‚   â”œâ”€â”€ ğŸ“‚ types/             # TypeScriptç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ ğŸ“‚ constants/         # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ ğŸ“‚ lib/               # å·¥å…·åº“
â”‚   â””â”€â”€ ğŸ“‚ styles/            # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ ğŸ“‚ entrypoints/           # WXTå…¥å£ç‚¹
â”‚   â”œâ”€â”€ background.ts         # åå°è„šæœ¬
â”‚   â”œâ”€â”€ content.ts           # å†…å®¹è„šæœ¬
â”‚   â”œâ”€â”€ popup/               # å¼¹çª—é¡µé¢
â”‚   â””â”€â”€ options/             # é€‰é¡¹é¡µé¢
â”œâ”€â”€ ğŸ“‚ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ dom/                 # DOMæ“ä½œ
â”‚   â”œâ”€â”€ highlight/           # é«˜äº®å·¥å…·
â”‚   â”œâ”€â”€ text/                # æ–‡æœ¬å¤„ç†
â”‚   â””â”€â”€ validation/          # æ•°æ®éªŒè¯
â”œâ”€â”€ ğŸ“‚ assets/               # é™æ€èµ„æº
â”‚   â”œâ”€â”€ icons/               # å›¾æ ‡æ–‡ä»¶
â”‚   â”œâ”€â”€ images/              # å›¾ç‰‡èµ„æº
â”‚   â””â”€â”€ fonts/               # å­—ä½“æ–‡ä»¶
â”œâ”€â”€ ğŸ“‚ docs/                 # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ ğŸ“‚ scripts/              # æ„å»ºè„šæœ¬
â””â”€â”€ ğŸ“‚ memory-bank/          # RIPERå†…å­˜ç³»ç»Ÿ
```

## ğŸ”„ å¼€å‘å·¥ä½œæµ

### Gitå·¥ä½œæµ
```bash
# åŠŸèƒ½å¼€å‘æµç¨‹
git checkout -b feature/tooltip-enhancement
# å¼€å‘ä»£ç ...
git add .
git commit -m "âœ¨ feat: tooltip | æ·»åŠ åŒé˜¶æ®µtooltipç³»ç»Ÿ"
git push origin feature/tooltip-enhancement
# åˆ›å»ºPR...

# æäº¤ä¿¡æ¯è§„èŒƒ
âœ¨ feat: æ–°åŠŸèƒ½
ğŸ› fix: ä¿®å¤bug
ğŸ“ docs: æ–‡æ¡£æ›´æ–°
ğŸ¨ style: ä»£ç æ ¼å¼
â™»ï¸ refactor: é‡æ„
âš¡ perf: æ€§èƒ½ä¼˜åŒ–
âœ… test: æµ‹è¯•ç›¸å…³
ğŸ”§ chore: æ„å»º/å·¥å…·
```

### ä»£ç å®¡æŸ¥æ¸…å•
- [ ] **åŠŸèƒ½å®Œæ•´æ€§** - æ˜¯å¦å®ç°æ‰€æœ‰éœ€æ±‚
- [ ] **ä»£ç è´¨é‡** - ESLint/Prettieræ£€æŸ¥é€šè¿‡
- [ ] **ç±»å‹å®‰å…¨** - TypeScriptç¼–è¯‘æ— é”™è¯¯
- [ ] **æµ‹è¯•è¦†ç›–** - å•å…ƒæµ‹è¯•è¦†ç›–ç‡>80%
- [ ] **æ€§èƒ½å½±å“** - æ— æ˜æ˜¾æ€§èƒ½å›å½’
- [ ] **å®‰å…¨æ£€æŸ¥** - æ— å®‰å…¨æ¼æ´
- [ ] **æ–‡æ¡£æ›´æ–°** - ç›¸å…³æ–‡æ¡£å·²æ›´æ–°

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•é‡‘å­—å¡”
```
        ğŸ”º E2Eæµ‹è¯• (5%)
       /              \
      /   é›†æˆæµ‹è¯• (15%) \
     /                    \
    /    å•å…ƒæµ‹è¯• (80%)     \
   /_________________________\
```

### æµ‹è¯•å‘½ä»¤
```bash
# å•å…ƒæµ‹è¯•
pnpm test              # ç›‘å¬æ¨¡å¼
pnpm test:run          # å•æ¬¡è¿è¡Œ
pnpm test:coverage     # è¦†ç›–ç‡æŠ¥å‘Š
pnpm test:ui           # å¯è§†åŒ–ç•Œé¢

# E2Eæµ‹è¯• (è®¡åˆ’ä¸­)
pnpm test:e2e          # ç«¯åˆ°ç«¯æµ‹è¯•
pnpm test:e2e:ui       # E2Eå¯è§†åŒ–
```

### æµ‹è¯•æ–‡ä»¶ç»“æ„
```
src/tests/
â”œâ”€â”€ unit/              # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ components/    # ç»„ä»¶æµ‹è¯•
â”‚   â”œâ”€â”€ services/      # æœåŠ¡æµ‹è¯•
â”‚   â””â”€â”€ utils/         # å·¥å…·æµ‹è¯•
â”œâ”€â”€ integration/       # é›†æˆæµ‹è¯•
â”œâ”€â”€ e2e/              # ç«¯åˆ°ç«¯æµ‹è¯•
â””â”€â”€ fixtures/         # æµ‹è¯•æ•°æ®
```

## ğŸš€ éƒ¨ç½²é…ç½®

### æ„å»ºå‘½ä»¤
```bash
# å¼€å‘æ„å»º
pnpm build             # Chromeç‰ˆæœ¬
pnpm build:firefox     # Firefoxç‰ˆæœ¬

# ç”Ÿäº§æ‰“åŒ…
pnpm zip               # Chrome zipåŒ…
pnpm zip:firefox       # Firefox zipåŒ…

# è´¨é‡æ£€æŸ¥
pnpm lint              # ä»£ç æ£€æŸ¥
pnpm type-check        # ç±»å‹æ£€æŸ¥
pnpm format:check      # æ ¼å¼æ£€æŸ¥
```

### æ„å»ºä¼˜åŒ–
```typescript
// wxt.config.ts ç”Ÿäº§ä¼˜åŒ–
export default defineConfig({
  vite: () => ({
    build: {
      minify: 'terser',           // ä»£ç å‹ç¼©
      sourcemap: false,           // ç”Ÿäº§ç¯å¢ƒå…³é—­sourcemap
      rollupOptions: {
        output: {
          manualChunks: {         // ä»£ç åˆ†å‰²
            vendor: ['react', 'react-dom'],
            utils: ['lodash-es']
          }
        }
      }
    }
  })
});
```

## ğŸ“Š ç›‘æ§è¿ç»´

### æ€§èƒ½ç›‘æ§
```typescript
// æ€§èƒ½æŒ‡æ ‡æ”¶é›†
interface PerformanceMetrics {
  highlightTime: number;      // é«˜äº®æ¸²æŸ“æ—¶é—´
  tooltipResponseTime: number; // Tooltipå“åº”æ—¶é—´
  memoryUsage: number;        // å†…å­˜ä½¿ç”¨é‡
  apiLatency: number;         // APIå»¶è¿Ÿ
}

// ç›‘æ§å®ç°
class PerformanceMonitor {
  static measure(name: string, fn: () => void) {
    const start = performance.now();
    fn();
    const end = performance.now();
    console.log(`${name}: ${end - start}ms`);
  }
}
```

### é”™è¯¯ç›‘æ§
```typescript
// å…¨å±€é”™è¯¯å¤„ç†
window.addEventListener('error', (event) => {
  console.error('Global Error:', {
    message: event.message,
    filename: event.filename,
    lineno: event.lineno,
    colno: event.colno,
    stack: event.error?.stack
  });
});

// Promiseé”™è¯¯å¤„ç†
window.addEventListener('unhandledrejection', (event) => {
  console.error('Unhandled Promise Rejection:', event.reason);
});
```

## ğŸ”§ æ•…éšœå¤„ç†

### å¸¸è§é—®é¢˜è§£å†³
```bash
# ä¾èµ–é—®é¢˜
rm -rf node_modules pnpm-lock.yaml
pnpm install

# æ„å»ºé—®é¢˜
pnpm clean              # æ¸…ç†æ„å»ºç¼“å­˜
pnpm build --verbose    # è¯¦ç»†æ„å»ºæ—¥å¿—

# ç±»å‹é—®é¢˜
pnpm type-check         # æ£€æŸ¥ç±»å‹é”™è¯¯
tsc --noEmit --verbose  # è¯¦ç»†ç±»å‹æ£€æŸ¥
```

### è°ƒè¯•æŠ€å·§
```typescript
// å¼€å‘ç¯å¢ƒè°ƒè¯•
if (process.env.NODE_ENV === 'development') {
  // å…¨å±€è°ƒè¯•å¯¹è±¡
  (window as any).__LUCID_DEBUG__ = {
    highlightService,
    tooltipManager,
    storageService
  };
}

// æ¡ä»¶æ–­ç‚¹
console.assert(condition, 'Assertion failed:', data);

// æ€§èƒ½åˆ†æ
console.time('operation');
// ... æ“ä½œä»£ç 
console.timeEnd('operation');
```

## ğŸ“‹ æœ€ä½³å®è·µ

### ä»£ç è§„èŒƒ
- **å‘½åçº¦å®š** - é©¼å³°å‘½åï¼Œè¯­ä¹‰åŒ–
- **æ–‡ä»¶ç»„ç»‡** - æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç»„
- **å¯¼å…¥é¡ºåº** - ç¬¬ä¸‰æ–¹ â†’ å†…éƒ¨ â†’ ç›¸å¯¹è·¯å¾„
- **æ³¨é‡Šè§„èŒƒ** - JSDocæ ¼å¼ï¼Œä¸­è‹±æ–‡ç»“åˆ

### æ€§èƒ½æœ€ä½³å®è·µ
- **é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“** - React.memo, useMemo
- **æ‰¹é‡DOMæ“ä½œ** - DocumentFragmentä½¿ç”¨
- **äº‹ä»¶å§”æ‰˜** - å‡å°‘äº‹ä»¶ç›‘å¬å™¨æ•°é‡
- **æ‡’åŠ è½½** - æŒ‰éœ€åŠ è½½ç»„ä»¶å’Œèµ„æº

### å®‰å…¨æœ€ä½³å®è·µ
- **è¾“å…¥éªŒè¯** - æ‰€æœ‰ç”¨æˆ·è¾“å…¥ä¸¥æ ¼éªŒè¯
- **XSSé˜²æŠ¤** - ä½¿ç”¨dangerouslySetInnerHTMLæ—¶è°¨æ…
- **CSPç­–ç•¥** - å†…å®¹å®‰å…¨ç­–ç•¥é…ç½®
- **æƒé™æœ€å°åŒ–** - åªç”³è¯·å¿…è¦çš„æµè§ˆå™¨æƒé™

---
*å¼€å‘æŒ‡å—ç‰ˆæœ¬: v1.0 | æœ€åæ›´æ–°: 2024å¹´12æœˆ*
