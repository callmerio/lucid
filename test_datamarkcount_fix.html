<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucid é‡æ–°é«˜äº® DataMarkCount ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }

        .test-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
        }

        .instructions {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .instructions h3 {
            margin-top: 0;
            color: #007bff;
        }

        .test-section {
            margin: 30px 0;
            padding: 25px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: #ffffff;
        }

        .test-section h3 {
            color: #495057;
            margin-top: 0;
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 10px;
        }

        .test-text {
            font-size: 16px;
            line-height: 1.8;
            margin: 15px 0;
        }

        .highlight-info {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 12px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 14px;
            color: #0066cc;
        }

        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
        }

        .debug-info h4 {
            margin-top: 0;
            color: #6c757d;
        }

        .step-indicator {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
        }

        .expected-result {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .expected-result strong {
            color: #155724;
        }

        .test-word {
            font-weight: bold;
            color: #dc3545;
            background: #fff5f5;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ Lucid DataMarkCount ä¿®å¤æµ‹è¯•</h1>

        <div class="instructions">
            <h3>ğŸ“‹ æµ‹è¯•è¯´æ˜</h3>
            <p>æœ¬æµ‹è¯•ä¸“é—¨éªŒè¯"é‡æ–°é«˜äº®æŒ‰ shift datamarkcount ä¸ä¼šå¢åŠ "é—®é¢˜çš„ä¿®å¤æ•ˆæœã€‚</p>

            <h4>ğŸ¯ æµ‹è¯•æ­¥éª¤ï¼š</h4>
            <ol>
                <li><span class="step-indicator">æ­¥éª¤1</span>é€‰æ‹©ä¸‹é¢ä»»æ„ä¸€ä¸ª <span class="test-word">"JavaScript"</span> è¯æ±‡</li>
                <li><span class="step-indicator">æ­¥éª¤2</span>æŒ‰ <kbd>Shift</kbd> é”®è¿›è¡Œé«˜äº®ï¼ˆåº”è¯¥çœ‹åˆ° data-mark-count="1"ï¼‰</li>
                <li><span class="step-indicator">æ­¥éª¤3</span>å†æ¬¡é€‰æ‹©åŒä¸€ä¸ªæˆ–ä¸åŒçš„ <span class="test-word">"JavaScript"</span> è¯æ±‡</li>
                <li><span class="step-indicator">æ­¥éª¤4</span>å†æ¬¡æŒ‰ <kbd>Shift</kbd> é”®</li>
                <li><span class="step-indicator">æ­¥éª¤5</span>æ£€æŸ¥æ‰€æœ‰ <span class="test-word">"JavaScript"</span> è¯æ±‡çš„ data-mark-count æ˜¯å¦éƒ½æ›´æ–°ä¸º 2</li>
                <li><span class="step-indicator">æ­¥éª¤6</span>é‡å¤æ­¥éª¤3-4ï¼ŒéªŒè¯è®¡æ•°æ˜¯å¦ç»§ç»­å¢åŠ </li>
            </ol>

            <div class="expected-result">
                <strong>é¢„æœŸç»“æœï¼š</strong>
                <ul>
                    <li>æ¯æ¬¡é‡æ–°é«˜äº®æ—¶ï¼Œæ‰€æœ‰ç›¸åŒè¯æ±‡çš„ data-mark-count éƒ½åº”è¯¥åŒæ­¥å¢åŠ </li>
                    <li>é«˜äº®é¢œè‰²åº”è¯¥éšç€è®¡æ•°å¢åŠ è€Œå˜æ·±</li>
                    <li>å³ä½¿é€‰æ‹©èŒƒå›´ç•¥æœ‰ä¸åŒï¼Œä¹Ÿåº”è¯¥èƒ½æ­£ç¡®è¯†åˆ«å¹¶å¢åŠ è®¡æ•°</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <h3>æµ‹è¯•æ–‡æœ¬ 1 - å¤šä¸ª JavaScript è¯æ±‡</h3>
            <div class="test-text">
                JavaScript is a versatile programming language. Modern JavaScript frameworks like React and Vue.js make JavaScript development more efficient. Learning JavaScript fundamentals is essential for web development.
            </div>
            <div class="highlight-info">
                ğŸ’¡ è¿™æ®µåŒ…å«4ä¸ª"JavaScript"è¯æ±‡ï¼Œæµ‹è¯•å…¨å±€åŒæ­¥æ›´æ–°åŠŸèƒ½
            </div>
        </div>

        <div class="test-section">
            <h3>æµ‹è¯•æ–‡æœ¬ 2 - æ··åˆå¤§å°å†™</h3>
            <div class="test-text">
                JAVASCRIPT and javascript are the same language. Whether you write JavaScript, Javascript, or javascript, they all refer to the same programming language.
            </div>
            <div class="highlight-info">
                ğŸ’¡ æµ‹è¯•ä¸åŒå¤§å°å†™çš„è¯æ±‡æ˜¯å¦èƒ½æ­£ç¡®è¯†åˆ«å’Œè®¡æ•°
            </div>
        </div>

        <div class="test-section">
            <h3>æµ‹è¯•æ–‡æœ¬ 3 - è¾¹ç•Œæƒ…å†µ</h3>
            <div class="test-text">
                JavaScript-based applications use JavaScript. The JavaScript engine processes JavaScript code efficiently. JavaScript's popularity makes JavaScript skills valuable.
            </div>
            <div class="highlight-info">
                ğŸ’¡ æµ‹è¯•å¸¦è¿å­—ç¬¦å’Œæ‰€æœ‰æ ¼å½¢å¼çš„è¯æ±‡å¤„ç†
            </div>
        </div>

        <div class="debug-info">
            <h4>ğŸ” è°ƒè¯•ä¿¡æ¯</h4>
            <p><strong>ä¿®å¤å†…å®¹ï¼ˆv2.0ï¼‰ï¼š</strong></p>
            <ul>
                <li><strong>å…¨é¢é‡æ„æ£€æµ‹é€»è¾‘ï¼š</strong>ä½¿ç”¨ä¸‰ç§æ–¹æ³•æ£€æµ‹å·²é«˜äº®è¯æ±‡</li>
                <li><strong>æ–¹æ³•1ï¼š</strong>æ£€æŸ¥é€‰åŒºèµ·å§‹ç‚¹æ˜¯å¦åœ¨é«˜äº®å…ƒç´ å†…</li>
                <li><strong>æ–¹æ³•2ï¼š</strong>æ£€æŸ¥é€‰åŒºæ–‡æœ¬æ˜¯å¦ä¸å·²æœ‰é«˜äº®è¯æ±‡åŒ¹é…</li>
                <li><strong>æ–¹æ³•3ï¼š</strong>æ£€æŸ¥é€‰åŒºä¸é«˜äº®å…ƒç´ æ˜¯å¦æœ‰äº¤é›†</li>
                <li><strong>ä¿®å¤å˜é‡å¼•ç”¨ï¼š</strong>ä½¿ç”¨ targetHighlight è€Œä¸æ˜¯ ancestorMark</li>
                <li><strong>å¢å¼ºæ—¥å¿—ï¼š</strong>æ·»åŠ è¯¦ç»†çš„é‡æ–°é«˜äº®æ—¥å¿—ä¿¡æ¯</li>
            </ul>

            <p><strong>æ£€æŸ¥æ–¹æ³•ï¼š</strong></p>
            <ul>
                <li>å³é”®ç‚¹å‡»é«˜äº®å…ƒç´  â†’ æ£€æŸ¥å…ƒç´ </li>
                <li>æŸ¥çœ‹ data-mark-count å±æ€§å€¼</li>
                <li>è§‚å¯Ÿé«˜äº®é¢œè‰²å˜åŒ–</li>
                <li>æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>æµ‹è¯•æ–‡æœ¬ 4 - é•¿æ–‡æœ¬æµ‹è¯•</h3>
            <div class="test-text">
                JavaScript has evolved significantly since its creation. Modern JavaScript includes features like arrow functions, async/await, and modules. JavaScript frameworks and libraries have made JavaScript development more productive. The JavaScript ecosystem continues to grow, with new JavaScript tools and JavaScript libraries being released regularly.
            </div>
            <div class="highlight-info">
                ğŸ’¡ æµ‹è¯•åœ¨é•¿æ–‡æœ¬ä¸­çš„å¤šæ¬¡é«˜äº®å’Œè®¡æ•°åŒæ­¥
            </div>
        </div>
    </div>

    <script>
        // æ·»åŠ ä¸€äº›è°ƒè¯•è¾…åŠ©åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”§ Lucid DataMarkCount ä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½');

            // ç›‘å¬é«˜äº®å…ƒç´ çš„å˜åŒ–
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList') {
                        mutation.addedNodes.forEach(function(node) {
                            if (node.nodeType === Node.ELEMENT_NODE &&
                                node.classList &&
                                node.classList.contains('lucid-highlight')) {
                                console.log('âœ… æ–°é«˜äº®å…ƒç´ å·²æ·»åŠ :', {
                                    word: node.dataset.word,
                                    markCount: node.dataset.markCount,
                                    element: node
                                });
                            }
                        });
                    }

                    if (mutation.type === 'attributes' &&
                        mutation.attributeName === 'data-mark-count') {
                        console.log('ğŸ“Š é«˜äº®è®¡æ•°å·²æ›´æ–°:', {
                            word: mutation.target.dataset.word,
                            oldCount: mutation.oldValue,
                            newCount: mutation.target.dataset.markCount,
                            element: mutation.target
                        });
                    }
                });
            });

            observer.observe(document.body, {
                childList: true,
                subtree: true,
                attributes: true,
                attributeOldValue: true,
                attributeFilter: ['data-mark-count']
            });
        });
    </script>
</body>
</html>
